<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Segment Routing over UDP(SRoU)</title>
<meta content="Kevin Fang" name="author">
<meta content="Yinghao Li" name="author">
<meta content="Feng Cai" name="author">
<meta content="
       This document defines the Segment Routing Header  extension
in UDP transport protocol with Network Address Translation Traversal. 
    " name="description">
<meta content="xml2rfc 3.5.0" name="generator">
<meta content="draft-zartbot-sr-udp-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.8.5
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.5.0
    pycairo 1.16.2
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 45.2.0
    six 1.15.0
-->
<link href="draft-zartbot-sr-udp.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Segment Routing over UDP(SRoU)</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fang, et al.</td>
<td class="center">Expires 15 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">SPRING</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zartbot-sr-udp-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-14" class="published">14 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-15">15 November 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Fang</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
<div class="author">
      <div class="author-name">Y. Li</div>
<div class="org">Google, Inc.</div>
</div>
<div class="author">
      <div class="author-name">F. Cai</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Segment Routing over UDP(SRoU)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the Segment Routing Header<span>[<a href="#RFC8754" class="xref">RFC8754</a>]</span> extension
in UDP transport protocol with Network Address Translation Traversal.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-specification-of-requiremen" class="xref">Specification of Requirements</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-motivation" class="xref">Motivation</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-sr-over-udpsrou-packet-enca" class="xref">SR over UDP(SRoU) Packet encapsulation</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-sr-over-udpsrou-header" class="xref">SR over UDP(SRoU) Header</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-packet-processing" class="xref">Packet Processing</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-type0x1-ipv4-locator-mode" class="xref">Type:0x1, IPv4 Locator Mode</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-general-forwarding-case" class="xref">General forwarding case</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-programable-forwarding-case" class="xref">Programable forwarding case</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-type0x2-srv6-format" class="xref">Type:0x2, SRv6 format</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-type0x3-compressed-segment-" class="xref">Type:0x3, Compressed Segment List</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-service-registration-mappin" class="xref">Service Registration &amp; Mapping</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-optional-tlv-2" class="xref">Optional TLV</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-sr-integrity-tlv" class="xref">SR Integrity TLV</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-micro-segmentationuseg" class="xref">Micro-segmentation(uSeg)</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-endpacketinfo" class="xref">End.PacketInfo</a><a href="#section-toc.1-1.3.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-oam" class="xref">OAM</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-performance-measurement" class="xref">Performance Measurement</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-pm_request-message" class="xref">PM_Request Message</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-pm_response-message" class="xref">PM_Response Message</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-stun-service" class="xref">STUN Service</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-usage" class="xref">Usage</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-traffic-engineering-over-in" class="xref">Traffic engineering over Internet</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-multipath-forwarding" class="xref">Multipath forwarding</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-micro-segmentation" class="xref">Micro Segmentation</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-container-network" class="xref">Container Network</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-mpls-sr-with-sdwan" class="xref">MPLS-SR with SDWAN</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-cloud-native-network-platfo" class="xref">Cloud Native Network platform</a><a href="#section-toc.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-srou-with-quic" class="xref">SRoU with QUIC</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref"></a><a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref"></a><a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref"></a><a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Many UDP based transport protocol(eg, IPSec/DTLS/QUIC) could provide a secure
transportation layer to handle overlay traffic. How ever it does not flexible
for source based path enforcement.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document defines a new Segment Routing Header in UDP payload to enable 
segment routing over UDP(SRoU) for IPSec/DTLS/QUIC or other UDP based traffic.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Segment Routing over UDP(SRoU) interworking with QUIC could provide a generic 
programmable and secure transport layer for next generation applications.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Discussion of this work is encouraged to happen on GitHub repository which
contains the draft: <a href="https://github.com/zartbot/draft-quic-sr">https://github.com/zartbot/draft-quic-sr</a><a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="specification-of-requirements">
<section id="section-1.1">
        <h3 id="name-specification-of-requiremen">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-specification-of-requiremen" class="section-name selfRef">Specification of Requirements</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP 14
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when,
they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="motivation">
<section id="section-1.2">
        <h3 id="name-motivation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.2-1">Segment Routing provides source-based path enforcement and transportation level
programmability but lacks of IPv4 support for transport over internet.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">MPLS-over-UDP<span>[<a href="#RFC7510" class="xref">RFC7510</a>]</span> and MPLS Segment Routing over IP<span>[<a href="#RFC8663" class="xref">RFC8663</a>]</span>
defined SR-MPLS over IPv4 network, but it lacks of NAT traversal capabilities.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Many SDWAN vendors defined their private protocols for routing control over
multiple public cloud and internet, it's hard for interop with multi-vendors.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">Many applications may require intelligence traffic steering(CDN/LB case), 
SRoU with QUIC could be used in these cases.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sr-over-udpsrou-packet-encapsulation">
<section id="section-2">
      <h2 id="name-sr-over-udpsrou-packet-enca">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-sr-over-udpsrou-packet-enca" class="section-name selfRef">SR over UDP(SRoU) Packet encapsulation</a>
      </h2>
<p id="section-2-1">The SRoU defined a generic segment routing enabled transport layer,the SR Header
insert in UDP payload.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span id="name-srou-encapsulation"></span><div id="srou-encap">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-2-2.1">
<pre>

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           IP Header                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           UDP Header                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          SRoU Header                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                            Payload                            +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-srou-encapsulation" class="selfRef">SRoU encapsulation</a>
        </figcaption></figure>
</div>
<div id="sr-over-udpsrou-header">
<section id="section-2.1">
        <h3 id="name-sr-over-udpsrou-header">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-sr-over-udpsrou-header" class="section-name selfRef">SR over UDP(SRoU) Header</a>
        </h3>
<p id="section-2.1-1">SR over UDP must be present at the head of UDP payload. The basic header
shows as below:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-srou-basic-header"></span><div id="srh-basic-format">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-2.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    MagicNum   |  SRoU Length  |H|T|S| F |   Reserve   |ProtoID|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  SegmentType  |   SRH Length  |   LastEntry   |  Segment Left |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          SegmentList[0](Length Based on Segment Type)         |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-srou-basic-header" class="selfRef">SRoU Basic Header</a>
          </figcaption></figure>
</div>
<p id="section-2.1-3">The full header shows as below which extend 3 fields:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">1.FlowID: could be used for flow tag and connection migration.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">2.SourceAddress and Port: used for NAT-T.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">3.HMAC: used for Header integrity check.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<span id="name-srou-full-header"></span><div id="srh-full-format">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-2.1-7.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    MagicNum   |  SRoU Length  |H|T|S| F |   Reserve   |ProtoID|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                       Flow ID(Optional)                       |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  SegmentType  |   SRH Length  |   LastEntry   |  Segment Left |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+               Source Address and Port(Optional)               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+          SegmentList[0](Length Based on Segment Type)         +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                               ...                             |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+          SegmentList[N](Length Based on Segment Type)         +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                    Optional Data (Variable)                   +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       HMAC(If H-bit set)                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-srou-full-header" class="selfRef">SRoU Full Header</a>
          </figcaption></figure>
</div>
<p id="section-2.1-8">Magic Number:
      1 Byte field
      For QUIC: could set to ALL ZERO to diffenciate with original header.
      For IPSec: could set to 0xFE value and avoid SPI allocation in
                 this range.
                 *0x00 may conflict with NON-ESP HEADER.
                 *0xFF may conflict with KeepAlive Message.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">SRoU Length:
      1 Byte, The byte length of a SRoU header.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<p id="section-2.1-10">H-Bit:
      1 Bit, request HMAC based Authentication Header.<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.1-11">T-Bit:
      1 Bit, request per-hop based inband telemetry.<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<p id="section-2.1-12">S-Bit:
      1 Bit, indicate Source Address and Port exist in SRH.<a href="#section-2.1-12" class="pilcrow">¶</a></p>
<p id="section-2.1-13">F-Bit:
      2 Bits, Flow ID Type<a href="#section-2.1-13" class="pilcrow">¶</a></p>
<span id="name-flow-id-type-field"></span><div id="flow-id-type">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-flow-id-type-field" class="selfRef">Flow ID type field</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Flow ID Length(bits)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">NO Flow</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Short ID</td>
              <td class="text-left" rowspan="1" colspan="1">64</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Long ID</td>
              <td class="text-left" rowspan="1" colspan="1">128</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Variable ID</td>
              <td class="text-left" rowspan="1" colspan="1">variable length</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.1-15">Protocol-ID:<a href="#section-2.1-15" class="pilcrow">¶</a></p>
<span id="name-protocol-id-field"></span><div id="protocol-id">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-protocol-id-field" class="selfRef">Protocol ID field</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Section</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">OAM</td>
              <td class="text-left" rowspan="1" colspan="1">for Link state probe and other OAM</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">IPv4</td>
              <td class="text-left" rowspan="1" colspan="1">Indicate inner payload is IPv4 pkt</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">IPv6</td>
              <td class="text-left" rowspan="1" colspan="1">Indicate inner payload is IPv6 pkt</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.1-17">Source Address:
       Protocol-ID = 1, this field is 4-Bytes IPv4 address
       Protocol-ID = 2, this field is 16-Bytes IPv6 address<a href="#section-2.1-17" class="pilcrow">¶</a></p>
<p id="section-2.1-18">Source Port:
       Source UDP Port Number<a href="#section-2.1-18" class="pilcrow">¶</a></p>
<p id="section-2.1-19">Segment Type:<a href="#section-2.1-19" class="pilcrow">¶</a></p>
<span id="name-segment-types"></span><div id="segment-types">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-segment-types" class="selfRef">Segment Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Len</th>
              <th class="text-left" rowspan="1" colspan="1">Section</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">IPv4 Address+ Port</td>
              <td class="text-left" rowspan="1" colspan="1">48b</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ipv4-locator" class="xref">Section 3.1</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">SRv6</td>
              <td class="text-left" rowspan="1" colspan="1">128b</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#srv6-locator" class="xref">Section 3.2</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Compressed Segment List</td>
              <td class="text-left" rowspan="1" colspan="1">128b</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#cSID" class="xref">Section 3.3</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-2.1-21">
          <dt id="section-2.1-21.1">
SR Hdr Len:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-21.2">
            <p id="section-2.1-21.2.1">SR Header length, include the SR Header flags  Segment-List and Optional TLV.<a href="#section-2.1-21.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-21.3">
Last Entry:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-21.4">
            <p id="section-2.1-21.4.1">contains the index(zero based), in the Segment List, of
the last element of the Segment List.<a href="#section-2.1-21.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-21.5">
Segments Left:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-21.6">
            <p id="section-2.1-21.6.1">8-bit unsigned integer. Number of route segemnts remaining,
i.e., number of explicitly listed intermediate nodes still
to be visited before reaching the final destination.<a href="#section-2.1-21.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-21.7">
Segment List[0..n]:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-21.8">
            <p id="section-2.1-21.8.1">128-bit/48-bit/144-bit addresses to represent the SR Policy.
Detailed forwarding behavior will be defined in <a href="#pkt-proccessing" class="xref">Section 3</a><a href="#section-2.1-21.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-21.9">
TLV:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-21.10">
            <p id="section-2.1-21.10.1">Opptional TLV used for future extension.currently only defined
the following TLV.<a href="#section-2.1-21.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-optional-tlv"></span><div id="optional-tlv-types">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-optional-tlv" class="selfRef">Optional TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Len</th>
              <th class="text-left" rowspan="1" colspan="1">Section</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Micro Segment Policy</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#useg-policy" class="xref">Section 3.4.2</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">End.PacketInfo</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#end-packet-info" class="xref">Section 3.4.3</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.1-23">VXLAN Replacement<a href="#section-2.1-23" class="pilcrow">¶</a></p>
<p id="section-2.1-24">Most Efficient Header shows<a href="#section-2.1-24" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pkt-proccessing">
<section id="section-3">
      <h2 id="name-packet-processing">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-packet-processing" class="section-name selfRef">Packet Processing</a>
      </h2>
<p id="section-3-1">This section describe the packet proccessing procedure. The following
topology will be used in this section.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-topology-for-packet-procces"></span><div id="pp-topology">
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-3-2.1">
<pre>
H1---R1----------I1------R3----------+---R4---H2
     |                               |
     |-----------R2------------------|
                 |
                 |
                 I2

I1,I2: Interim Node that support SRoU
R1~R4: Traditional Router
H1,H2: Host
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-topology-for-packet-procces" class="selfRef">Topology for packet proccesing</a>
        </figcaption></figure>
</div>
<span id="name-ip-address-table"></span><div id="ipv4-addr">
<table class="center" id="table-5">
        <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-ip-address-table" class="selfRef">IP address table</a>
        </caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">Host</th>
            <th class="text-left" rowspan="1" colspan="1">Address</th>
            <th class="text-left" rowspan="1" colspan="1">SRoU Port</th>
            <th class="text-left" rowspan="1" colspan="1">Post NAT</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">H1</td>
            <td class="text-left" rowspan="1" colspan="1">192.168.1.2</td>
            <td class="text-left" rowspan="1" colspan="1">5111</td>
            <td class="text-left" rowspan="1" colspan="1">10.1.1.1:23456</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">R1</td>
            <td class="text-left" rowspan="1" colspan="1">192.168.1.1/10.1.1.1</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">R2</td>
            <td class="text-left" rowspan="1" colspan="1">10.1.2.2</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">R3</td>
            <td class="text-left" rowspan="1" colspan="1">10.1.3.3</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">R4</td>
            <td class="text-left" rowspan="1" colspan="1">10.1.4.4</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">H2</td>
            <td class="text-left" rowspan="1" colspan="1">10.99.2.2</td>
            <td class="text-left" rowspan="1" colspan="1">443</td>
            <td class="text-left" rowspan="1" colspan="1">10.1.4.4:443</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">I1</td>
            <td class="text-left" rowspan="1" colspan="1">10.99.1.1</td>
            <td class="text-left" rowspan="1" colspan="1">8811</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">I2</td>
            <td class="text-left" rowspan="1" colspan="1">192.168.99.2</td>
            <td class="text-left" rowspan="1" colspan="1">8822</td>
            <td class="text-left" rowspan="1" colspan="1">10.1.2.2:12345</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="ipv4-locator">
<section id="section-3.1">
        <h3 id="name-type0x1-ipv4-locator-mode">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-type0x1-ipv4-locator-mode" class="section-name selfRef">Type:0x1, IPv4 Locator Mode</a>
        </h3>
<p id="section-3.1-1">In this mode, the endpoint could directly insert the interim node IPv4
addresses and port into the segment-list.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="general-forwarding-case">
<section id="section-3.1.1">
          <h4 id="name-general-forwarding-case">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-general-forwarding-case" class="section-name selfRef">General forwarding case</a>
          </h4>
<p id="section-3.1.1-1">For example, H1 intend to send packet to H2 via R1--&gt;I2----&gt;H2, 
In this case SRoU packet will be NATed twice to show the NAT traversal workflow.
I2's public address could use STUN<span>[<a href="#RFC5389" class="xref">RFC5389</a>]</span> protocol detected and sync to all 
SRoU enabled devices.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">H1 send packet with SRoU Header as below, H1 could use STUN detect it's source
public address, but consider the simplicity, the 1st hop SRoU forwarder cloud
update the source ip/port field in SRoU header.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<span id="name-type0x1-h1-i2-packet-header"></span><div id="type-1-h1-i2">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-3.1.1-3.1">
<pre>
IP/UDP Header {
  Source IP: 192.168.1.2,
  Destination IP: 10.1.2.2(SegmentList[1],I2 Pre-NAT public address),
  Source Port: 5111,
  Destination Port: 12345(SegmentList[1],I2 Pre-NAT public port),
}
SRoU Header {
  Magic Num = 0x0
  SRoU Length = 29
  FlowID Length = 0x3
  Protocol-ID = 0x1(IPv4),
  FlowID =  0x123,
  Source Address = 192.168.1.2,
  Source Port = 5111,
  Segment Left = 0x1,
  Last Entry   = 0x1,
  SegmenetList[0] = 10.1.4.4:443(H2),
  SegmenetList[1] = 10.1.2.2:12345(I2),
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-type0x1-h1-i2-packet-header" class="selfRef">Type:0x1 H1--&gt;I2 Packet Header</a>
            </figcaption></figure>
</div>
<p id="section-3.1.1-4">R1 is a NAT Device it will change the Source IP/Port to 10.1.1.1:23456.
But this router may not have ALG function to modify SRoU Header.Then packet
will send to 10.1.2.2:12345. It will be NAT again to I2.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">After twice NAT, I2 Recieved packet as below:<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
<span id="name-type0x1-h1-i2-i2-recieved-p"></span><div id="type-1-i2-recieved">
<figure id="figure-6">
            <div class="artwork art-text alignLeft" id="section-3.1.1-6.1">
<pre>
IP/UDP Header {
  Source IP: 10.1.1.1(H1 post NAT addr),
  Destination IP: 192.168.99.2(I2 private addr),
  Source Port: 23456(H1 post NAT port),
  Destination Port: 8822(I2 private port),
}
SRoU Header {
  Magic Num = 0x0
  SRoU Length = 29
  FlowID Length = 0x3
  Protocol-ID = 0x1(IPv4),
  FlowID =  0x123,
  Source Address = 192.168.1.2,
  Source Port = 5111,
  Segment Left = 0x1,
  Last Entry   = 0x1,
  SegmenetList[0] = 10.1.4.4:443(H2),
  SegmenetList[1] = 10.1.2.2:12345(I2),
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-type0x1-h1-i2-i2-recieved-p" class="selfRef">Type:0x1 H1--&gt;I2, I2 Recieved Packet Header</a>
            </figcaption></figure>
</div>
<p id="section-3.1.1-7">if the (LastEntry == Segment Left) indicate I2 is the 1st hop SRoU forwarder,
It MUST apply ALG to update the Source Address/Port field by the IP/UDP header.
Then it will execute Segment Left - 1, and copy SegmentList[0] to DA/Dport.
Consider some interim router like R2 has URPF checking, the SA/Sport will also
updated to I2 SRoU socket address.<a href="#section-3.1.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1.1-8">I2---&gt;H2 packet:<a href="#section-3.1.1-8" class="pilcrow">¶</a></p>
<span id="name-type0x1-i2-h2-packet-header"></span><div id="type-1-i2h2">
<figure id="figure-7">
            <div class="artwork art-text alignLeft" id="section-3.1.1-9.1">
<pre>
IP/UDP Header {
  Source IP: 192.168.00.2(I2 Private),
  Destination IP: 10.1.4.4(SegmentList[0]),
  Source Port: 8822(I2 Private),
  Destination Port: 443(SegmentList[0]),
}
SRoU Header {
  Magic Num = 0x0
  SRoU Length = 29
  FlowID Length = 0x3
  Protocol-ID = 0x1(IPv4),
  FlowID =  0x123,
  Source Address = 10.1.1.1(update by I2 ALG),
  Source Port = 23456(update by I2 ALG),
  Segment Left = 0x0(SL--),
  Last Entry   = 0x1,
  SegmenetList[0] = 10.1.4.4:443(H2),
  SegmenetList[1] = 10.1.2.2:12345(I2),
}
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-type0x1-i2-h2-packet-header" class="selfRef">Type:0x1 I2--&gt;H2 Packet Header</a>
            </figcaption></figure>
</div>
<p id="section-3.1.1-10">H2 will recieve the packet, and if the segment left == 0, it MUST copy the 
Source Address and Port into IP/UDP Header and strip out the SRoU Header and
send to udp socket. It may cache the reversed segmentlist for symmetric routing.<a href="#section-3.1.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1.1-11">H2 send to UDP socket<a href="#section-3.1.1-11" class="pilcrow">¶</a></p>
<span id="name-type0x1-h2-send-to-udp-sock"></span><div id="type-1-h2tx">
<figure id="figure-8">
            <div class="artwork art-text alignLeft" id="section-3.1.1-12.1">
<pre>
IP/UDP Header {
  Source IP: 10.1.1.1(Copied from SRoU Src field),
  Destination IP: 10.99.2.2(Static NAT by R4),
  Source Port: 23456(Copied from SRoU Src field),
  Destination Port: 443(SegmentList[0]),
}
UDP Payload {
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-type0x1-h2-send-to-udp-sock" class="selfRef">Type:0x1 H2 Send to UDP socket</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="programable-forwarding-case">
<section id="section-3.1.2">
          <h4 id="name-programable-forwarding-case">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-programable-forwarding-case" class="section-name selfRef">Programable forwarding case</a>
          </h4>
<p id="section-3.1.2-1">In type:0x1 mode, each segment has 48bit(32bit IPv4 address with 16bit port).
It could be defined for programable forwarding with special IPv4 prefix( ie. 
255.0.0.0/8):<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">Prefix:&lt;32bit functions and args&gt;<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2-3">For exmaple we could defined EVPN/VPNv4/VPNv6 function in SRoU header by SID:<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2-4">255:&lt;16bit End.X function&gt;:&lt;24bit VPN ID&gt;<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="srv6-locator">
<section id="section-3.2">
        <h3 id="name-type0x2-srv6-format">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-type0x2-srv6-format" class="section-name selfRef">Type:0x2, SRv6 format</a>
        </h3>
<p id="section-3.2-1">IPv6 does not need to consider the NAT traversal case, In this mode almost 
forwarding action is same as SRv6. This is only used for application driven
traffic steering(like CDN/LB usecase.). It has some benefit interworking with
QUIC, the pure userspace implementation could provide additional flexibility.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">For example some IOT sensor with legacy kernel stack does not support SRv6 could
use SRoU insert SRH in UDP payload, the 1st hop SRoU forwarder could convert it
to standard SRv6 packet.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cSID">
<section id="section-3.3">
        <h3 id="name-type0x3-compressed-segment-">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-type0x3-compressed-segment-" class="section-name selfRef">Type:0x3, Compressed Segment List</a>
        </h3>
<div id="service-registration-mapping">
<section id="section-3.3.1">
          <h4 id="name-service-registration-mappin">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-service-registration-mappin" class="section-name selfRef">Service Registration &amp; Mapping</a>
          </h4>
<p id="section-3.3.1-1">I1,I2 use SRoU port as source port to inital STUN<span>[<a href="#RFC5389" class="xref">RFC5389</a>]</span> session to SR
mapping server, the mapping server could detect the Post NAT address and assign
SID for each host, and distribute IP/port--SID mapping database to all the SRoU
enabled host.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<span id="name-sid-mapping"></span><div id="sid_map">
<table class="center" id="table-6">
            <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-sid-mapping" class="selfRef">sid mapping</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Host</th>
                <th class="text-left" rowspan="1" colspan="1">Socket</th>
                <th class="text-left" rowspan="1" colspan="1">SID</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">I1</td>
                <td class="text-left" rowspan="1" colspan="1">10.99.1.1:8811</td>
                <td class="text-left" rowspan="1" colspan="1">1111</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">I2</td>
                <td class="text-left" rowspan="1" colspan="1">10.1.2.2:12345</td>
                <td class="text-left" rowspan="1" colspan="1">2222</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.3.1-3">In this mode the socket information could combined with IPv4 and IPv6.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="optional-tlv">
<section id="section-3.4">
        <h3 id="name-optional-tlv-2">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-optional-tlv-2" class="section-name selfRef">Optional TLV</a>
        </h3>
<div id="sr-integrity">
<section id="section-3.4.1">
          <h4 id="name-sr-integrity-tlv">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-sr-integrity-tlv" class="section-name selfRef">SR Integrity TLV</a>
          </h4>
<p id="section-3.4.1-1">SR Integrity Tag to validate the SRH. All fields in the SRH except
 Segments Left fields need to be checked.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="useg-policy">
<section id="section-3.4.2">
          <h4 id="name-micro-segmentationuseg">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-micro-segmentationuseg" class="section-name selfRef">Micro-segmentation(uSeg)</a>
          </h4>
<p id="section-3.4.2-1">Option-TLV could defined Sub-TLV to support Micro-segmentation Security policy<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.2-2">
<pre>
  OptionTLV {
    0x1, uSeg{
        0x0, SRC_GROUP_ID,
        0x1, DST_GROUP_ID,
        0x2, APP_GROUP_ID,
        0x3, SRC_DEVICE_ID,
        0x4, DST_DEVICE_ID,
        0x5, APP_ID,
    }
  }
</pre><a href="#section-3.4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4.2-3">Customer also could encode this microsegment policy header in flowID field.<a href="#section-3.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="end-packet-info">
<section id="section-3.4.3">
          <h4 id="name-endpacketinfo">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-endpacketinfo" class="section-name selfRef">End.PacketInfo</a>
          </h4>
<p id="section-3.4.3-1">This optional TLV defines extened packet info and Segment-end packet edit
function. Sub-TLV defines as below:<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<div id="type0x0-vpn-id">
<section id="section-3.4.3.1">
            <h5 id="name-type0x0-vpn-id">
<a href="#section-3.4.3.1" class="section-number selfRef">3.4.3.1. </a><a href="#name-type0x0-vpn-id" class="section-name selfRef">Type:0x0, VPN-ID</a>
            </h5>
<p id="section-3.4.3.1-1">The SDWAN Router could use <span>[<a href="#I-D.ietf-quic-datagram" class="xref">I-D.ietf-quic-datagram</a>]</span> as VPN tunnel, This
 Sub-TLV defined the VPN-ID inside the tunnel.<a href="#section-3.4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3.1-2">If SRoU header has this sub-TLV, the device MUST decrypt inner payload and
 use the VPN-ID for inner packet destination lookup.<a href="#section-3.4.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="type0x1-orginal-destination-addressport">
<section id="section-3.4.3.2">
            <h5 id="name-type0x1-orginal-destination">
<a href="#section-3.4.3.2" class="section-number selfRef">3.4.3.2. </a><a href="#name-type0x1-orginal-destination" class="section-name selfRef">Type:0x1, Orginal Destination Address/Port</a>
            </h5>
<p id="section-3.4.3.2-1">In SR Type 0x3, The original destination address/port cloud not encode in 128bit
field, it could be store in option TLV.<a href="#section-3.4.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="oam">
<section id="section-4">
      <h2 id="name-oam">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-oam" class="section-name selfRef">OAM</a>
      </h2>
<p id="section-4-1">SRoU OAM Packet format is defined as below:<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-srou-oam-header"></span><div id="oam-format">
<figure id="figure-9">
        <div class="artwork art-text alignLeft" id="section-4-2.1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Magic Number  |  SRoU Length  | Flow ID Length|  P-ID  =0x0   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                 Flow ID( Variable length)                     |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | OAM-Type      |   OAM Payload(Variable Length based on Type)  |
 +-+-+-+-+-+-+-+-+                                               +
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-srou-oam-header" class="selfRef">SRoU OAM Header</a>
        </figcaption></figure>
</div>
<p id="section-4-3">OAM-Type:<a href="#section-4-3" class="pilcrow">¶</a></p>
<span id="name-oam-message-type"></span><div id="oam_type">
<table class="center" id="table-7">
        <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-oam-message-type" class="selfRef">oam message type</a>
        </caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">ID</th>
            <th class="text-center" rowspan="1" colspan="1">Type</th>
            <th class="text-left" rowspan="1" colspan="1">Usage</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0</td>
            <td class="text-center" rowspan="1" colspan="1">PM</td>
            <td class="text-left" rowspan="1" colspan="1">Latency &amp; Loss &amp; Jitter Measurement</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">1</td>
            <td class="text-center" rowspan="1" colspan="1">IPv4 STUN Request</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">2</td>
            <td class="text-center" rowspan="1" colspan="1">IPv4 STUN Response</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">3</td>
            <td class="text-center" rowspan="1" colspan="1">IPv6 STUN Request</td>
            <td class="text-left" rowspan="1" colspan="1">*Reserved for NAT66 Case(Not implement yet)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">4</td>
            <td class="text-center" rowspan="1" colspan="1">IPv6 STUN Response</td>
            <td class="text-left" rowspan="1" colspan="1">*Reserved for NAT66 Case(Not implement yet)</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="performance-measurement">
<section id="section-4.1">
        <h3 id="name-performance-measurement">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-performance-measurement" class="section-name selfRef">Performance Measurement</a>
        </h3>
<p id="section-4.1-1">The performance measurement message is follow TWAMP algorithm.This OAM message 
could be used for Authentication mode( with HMAC-SHA256) or 
Crypt mode(AES-GCM-256).
Crypto key could be synchonized via out-of-band channel.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">PMType:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span id="name-oam-perf-measurement-messag"></span><div id="oam_pm_type">
<table class="center" id="table-8">
          <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-oam-perf-measurement-messag" class="selfRef">oam perf measurement message type</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-center" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0</td>
              <td class="text-center" rowspan="1" colspan="1">PM_Request</td>
              <td class="text-left" rowspan="1" colspan="1">Performance Measurement</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-center" rowspan="1" colspan="1">PM_Response</td>
              <td class="text-left" rowspan="1" colspan="1">Performance Measurement</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="pmrequest-message">
<section id="section-4.1.1">
          <h4 id="name-pm_request-message">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-pm_request-message" class="section-name selfRef">PM_Request Message</a>
          </h4>
<p id="section-4.1.1-1">The initiator send packet with PMType = 0, and it contains sending 
timestamp.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<span id="name-srou-oam-perf-measurement-r"></span><div id="oam-ls-req-format">
<figure id="figure-10">
            <div class="artwork art-text alignLeft" id="section-4.1.1-2.1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | OAM Type=0    |PMType=0      |    MBZ                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                         Sequence Number                       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          TimeStamp                            |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        HMAC(Optional)                         |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-srou-oam-perf-measurement-r" class="selfRef">SRoU OAM Perf Measurement Request Message</a>
            </figcaption></figure>
</div>
<p id="section-4.1.1-3">Sequence Number: 
    Start from zero, add one after send request packet.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">TimeStamp: 
    Packet sending timestamp.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">HMAC(Optional): 
    HMAC-SHA256 used for message authentication.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pmresponse-message">
<section id="section-4.1.2">
          <h4 id="name-pm_response-message">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-pm_response-message" class="section-name selfRef">PM_Response Message</a>
          </h4>
<p id="section-4.1.2-1">The responder message is with PMType = 1, and it contains:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<span id="name-srou-oam-perf-measurement-re"></span><div id="oam-pm-resp-format">
<figure id="figure-11">
            <div class="artwork art-text alignLeft" id="section-4.1.2-2.1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | OAM Type=0    |PMType=1      |    MBZ                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Sequence Number                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                         TimeStamp                             |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                     Recieved TimeStamp                        |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Sender Sequence Number                     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Sender TimeStamp                        |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        HMAC(Optional)                         |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-srou-oam-perf-measurement-re" class="selfRef">SRoU OAM Perf Measurement Response Message</a>
            </figcaption></figure>
</div>
<p id="section-4.1.2-3">Sequence Number: 
    Start from zero, add one after send response packet.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">TimeStamp: 
    sending timestamp.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">Recieved Timestamp: 
    The correspond request message recieved timestamp.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">Sender Sequence Number: 
    Exactly copied from the correspond request message<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2-7">Sender Timestamp:
    Exactly copied from the correspond request message<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8">HMAC(Optional): 
    HMAC-SHA256 used for message authentication.<a href="#section-4.1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="stun-service">
<section id="section-4.2">
        <h3 id="name-stun-service">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-stun-service" class="section-name selfRef">STUN Service</a>
        </h3>
<p id="section-4.2-1">SRoU forwarding endpoint may stay behind NAT, it request STUN service to 
discover the public network address.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Initiator send address and port with ALL-ZERO to STUN Server, STUN server
copy the recieve source address and port in this payload, and generate HMAC.
The STUN Server's key could be propogate to initiator by a out-of-band channel.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-srou-oam-stun-header"></span><div id="oam-stun-format">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-4.2-3.1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | OAM Type=0    |                   MBZ                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       IP Address                              |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |    Port                       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          HMAC                                 |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-srou-oam-stun-header" class="selfRef">SRoU OAM STUN Header</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="usage">
<section id="section-5">
      <h2 id="name-usage">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-usage" class="section-name selfRef">Usage</a>
      </h2>
<div id="traffic-engineering-over-internet">
<section id="section-5.1">
        <h3 id="name-traffic-engineering-over-in">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-traffic-engineering-over-in" class="section-name selfRef">Traffic engineering over Internet</a>
        </h3>
<span id="name-traffic-engineering-over-int"></span><div id="use-1">
<figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-5.1-1.1">
<pre>
Client-------R1------------Internet--------------R2-----------Server
             |                                    |
             |                                    |
             R3----V1----PubliCloud--------V2-----|
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-traffic-engineering-over-int" class="selfRef">Traffic Engineering over internet</a>
          </figcaption></figure>
</div>
<p id="section-5.1-2">Many video/conferencing application requires traffic engineering over IPv4 
Internet, Webex/Zoom/Teams may setup V1,V2 in public cloud, The client and 
server could encode the V1/V2 information in SRoU header for traffic engineering<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multipath-forwarding">
<section id="section-5.2">
        <h3 id="name-multipath-forwarding">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-multipath-forwarding" class="section-name selfRef">Multipath forwarding</a>
        </h3>
<p id="section-5.2-1">Same as previously topoloy <a href="#use-1" class="xref">Figure 13</a>, customer cloud ask server transmit packet
over different path, two path have same Flow-ID, QUIC could be used in this case
to provide multistream/multihoming support.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="micro-segmentation">
<section id="section-5.3">
        <h3 id="name-micro-segmentation">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-micro-segmentation" class="section-name selfRef">Micro Segmentation</a>
        </h3>
<p id="section-5.3-1">Same as previously topoloy <a href="#use-1" class="xref">Figure 13</a>, the interim Router: R1/R2/R3, V1,V2 could
insert uSeg Sub-TLV based on client and server uSeg identity, and other interim
network equipment could based on this sub-TLV implement security policy or QoS
policy.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="container-network">
<section id="section-5.4">
        <h3 id="name-container-network">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-container-network" class="section-name selfRef">Container Network</a>
        </h3>
<span id="name-service-mesh-container-netw"></span><div id="use-3">
<figure id="figure-14">
          <div class="artwork art-text alignLeft" id="section-5.4-1.1">
<pre>
C1----SideCar1-----L1-----S1------L2----SideCar2-------C2
                   |               |
                   |------S2-------|
C1,C2: Container
L1,L2: Leaf switch
S1,S2: Spine switch
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-service-mesh-container-netw" class="selfRef">Service-Mesh &amp; Container Network</a>
          </figcaption></figure>
</div>
<p id="section-5.4-2">SRoU with QUIC also could be used for container network interface, especially 
for service-mesh sidecar. The sidecar could aware the Datacenter underlay 
topology by BGP-LinkState, and use SRH select best path to avoid congestion. 
At the same time, all traffic are encrypted by <span>[<a href="#I-D.ietf-quic-tls" class="xref">I-D.ietf-quic-tls</a>]</span>.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mpls-sr-with-sdwan">
<section id="section-5.5">
        <h3 id="name-mpls-sr-with-sdwan">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-mpls-sr-with-sdwan" class="section-name selfRef">MPLS-SR with SDWAN</a>
        </h3>
<span id="name-mpls-sr-with-sdwan-2"></span><div id="sr-sdwan-topology">
<figure id="figure-15">
          <div class="artwork art-text alignLeft" id="section-5.5-1.1">
<pre>
S1---INET(ipv4)----PE1------MPLS------PE2----S2

S1,S2: SDWAN Router
PE1,PE2: SR enabled MPLS PE
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-mpls-sr-with-sdwan-2" class="selfRef">MPLS-SR with SDWAN</a>
          </figcaption></figure>
</div>
<p id="section-5.5-2">S1 will setup IPSec SA with S2 for end-to-end encryption,
And it will use BSID between PE1--PE2 for traffic engineering.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">MPLS based BSID and IPv4 based locator could be encoded in uSID.A distributed
mapping table could be used to translate uSID to packet action.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<span id="name-type0x1-s1-pe1-packet-heade"></span><div id="type-1-s1-pe1">
<figure id="figure-16">
          <div class="artwork art-text alignLeft" id="section-5.5-4.1">
<pre>
IP/UDP Header {
  Source IP: H1,
  Destination IP: PE1,
  Source Port: srcport,
  Destination Port: IPSec,
}
SRoU Header {
  SegmentType = 0x1,
  SR_HDR_Len = 2,
  Last Entry = 0x0,
  Segment Left = 0,
  SegmenetList[0] = uSID: FC0:2222:3333:4444::
}
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-type0x1-s1-pe1-packet-heade" class="selfRef">Type:0x1 S1--&gt;PE1 Packet Header</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="cloud-native-network-platform">
<section id="section-5.6">
        <h3 id="name-cloud-native-network-platfo">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-cloud-native-network-platfo" class="section-name selfRef">Cloud Native Network platform</a>
        </h3>
<p id="section-5.6-1">Each of the SRoU forwarder only rely on a UDP socket, it could be implement
by a container. Customer could deploy such SRoU enable container in multiple
cloud to provide a cloud-angonostic solution. All containers could be managed
by K8S.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">A distributed K-V store could be used for SRoU forwarder service registration,
routing(announce prefix), all the SRoU forwarder could measue peer's 
reachability/jitter/loss and update link-state to the K-V store. forwarding 
policy also could be sync by the K-V store. Detailed information will be
provided in another I.D(ETCD based disaggregated SDN control plane).<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.6-3">SRoU forwarder also could be implement by BPF for container communication. It 
will provide host level traffic engineering for massive scale datacenter to 
reduce the West-East traffic congestion.<a href="#section-5.6-3" class="pilcrow">¶</a></p>
<p id="section-5.6-4">The best practice for SRoU is working with QUIC.
SRoU with QUIC transport protocol provides the following benefit for SDWAN :<a href="#section-5.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-5.1">Stream multiplexing<a href="#section-5.6-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.6-5.2">Stream and connection-level flow control<a href="#section-5.6-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.6-5.3">Low-latency connection establishment<a href="#section-5.6-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.6-5.4">Connection migration and resilience to NAT rebinding<a href="#section-5.6-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.6-5.5">Authenticated and encrypted header and payload<a href="#section-5.6-5.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.6-6">SRoU add traffic-engineering and VPN capabilites for SDWAN.
Many existing SDWAN features could gain the benefits like:<a href="#section-5.6-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-7.1">TCP optimization<a href="#section-5.6-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.6-7.2">Packet duplication<a href="#section-5.6-7.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">The SRoU forwarder must validate the packet, FlowID could be used for source
validation. It could be a token based solution, this token could be assigned
by controller with a dedicated expire time. Source/Dest device ID and group 
cloud encode in flowid and signed by controller, just like JWT.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">A blacklist on controller k-v store could be implemented to block device when 
the token does not expire.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="srou-with-quic">
<section id="section-7.1">
        <h3 id="name-srou-with-quic">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-srou-with-quic" class="section-name selfRef">SRoU with QUIC</a>
        </h3>
<p id="section-7.1-1">The magic number in SRoU must be ZERO to distiguish with QUIC Long/Short 
packet format.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">The following people provided substantial contributions to this document:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">Bin Shi, Cisco Systems, Inc.<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.2">Yijen Wang, Cisco Systems, Inc.<a href="#section-8-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.3">Pix Xu, Cisco Systems, Inc.<a href="#section-8-2.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-quic-datagram">[I-D.ietf-quic-datagram]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span><span class="refAuthor">, Kinnear, E.</span><span class="refAuthor">, and D. Schinazi</span>, <span class="refTitle">"An Unreliable Datagram Extension to QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-datagram-02</span>, <time datetime="2021-02-16" class="refDate">16 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-quic-datagram-02.txt">https://www.ietf.org/archive/id/draft-ietf-quic-datagram-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-tls">[I-D.ietf-quic-tls]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span><span class="refAuthor"> and S. Turner</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-tls-34</span>, <time datetime="2021-01-14" class="refDate">14 January 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-quic-tls-34.txt">https://www.ietf.org/archive/id/draft-ietf-quic-tls-34.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5389">[RFC5389]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span><span class="refAuthor">, Mahy, R.</span><span class="refAuthor">, Matthews, P.</span><span class="refAuthor">, and D. Wing</span>, <span class="refTitle">"Session Traversal Utilities for NAT (STUN)"</span>, <span class="seriesInfo">RFC 5389</span>, <span class="seriesInfo">DOI 10.17487/RFC5389</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5389">https://www.rfc-editor.org/info/rfc5389</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7510">[RFC7510]</dt>
        <dd>
<span class="refAuthor">Xu, X.</span><span class="refAuthor">, Sheth, N.</span><span class="refAuthor">, Yong, L.</span><span class="refAuthor">, Callon, R.</span><span class="refAuthor">, and D. Black</span>, <span class="refTitle">"Encapsulating MPLS in UDP"</span>, <span class="seriesInfo">RFC 7510</span>, <span class="seriesInfo">DOI 10.17487/RFC7510</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7510">https://www.rfc-editor.org/info/rfc7510</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8663">[RFC8663]</dt>
        <dd>
<span class="refAuthor">Xu, X.</span><span class="refAuthor">, Bryant, S.</span><span class="refAuthor">, Farrel, A.</span><span class="refAuthor">, Hassan, S.</span><span class="refAuthor">, Henderickx, W.</span><span class="refAuthor">, and Z. Li</span>, <span class="refTitle">"MPLS Segment Routing over IP"</span>, <span class="seriesInfo">RFC 8663</span>, <span class="seriesInfo">DOI 10.17487/RFC8663</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8663">https://www.rfc-editor.org/info/rfc8663</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8754">[RFC8754]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span><span class="refAuthor">, Dukes, D., Ed.</span><span class="refAuthor">, Previdi, S.</span><span class="refAuthor">, Leddy, J.</span><span class="refAuthor">, Matsushima, S.</span><span class="refAuthor">, and D. Voyer</span>, <span class="refTitle">"IPv6 Segment Routing Header (SRH)"</span>, <span class="seriesInfo">RFC 8754</span>, <span class="seriesInfo">DOI 10.17487/RFC8754</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8754">https://www.rfc-editor.org/info/rfc8754</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kevin Fang</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:zartbot.ietf@gmail.com" class="email">zartbot.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yinghao Li</span></div>
<div dir="auto" class="left"><span class="org">Google, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:liyinghao@gmail.com" class="email">liyinghao@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Feng Cai</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fecai@cisco.com" class="email">fecai@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
